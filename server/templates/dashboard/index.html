{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block style %}
<style>
    .grid {
        width: 100%;
    }
    /* clear fix */
    .grid:after {
        content: '';
        display: block;
        clear: both;
    }
    .grid-item {
    }
    .grid-item-w-100 {
        width: 100%;
    }
    .grid-item-w-50 {
        width: 50%;
    }
    .grid-item-w-25 {
        width: 25%;
    }
    .grid-item {
        
    }
    .grid-item-inner {
        padding: 10px;
        width: 100%;
    }
    /* Draggabilly adds is-dragging */
    .grid-item.is-dragging, .grid-item.is-positioning-post-drag {
        background: #C90;
        z-index: 2; /* keep dragged item on top */
    }
    .packery-drop-placeholder {
        outline: 3px dashed #444;
        outline-offset: -6px;
        /* transition position changing */
        -webkit-transition: -webkit-transform 0.2s;
                transition: transform 0.2s;
    }
    .info-icon {
        margin-top: 6px;
        margin-left: 6px;
        cursor: pointer;
        color: black;
        font-size: 16px;
    }
</style>
{% endblock %}

{% block script %}
<script src="{{ url_for('static', filename='js/packery.min.js' )}}"></script>
<script src="{{ url_for('static', filename='js/plotly-latest.min.js' )}}"></script>

<script>
    $(document).ready(function() { 
        $grid = $('.grid').packery({
            // options
            itemSelector: '.grid-item',
            gutter: 0,
            
        });
        $('[data-toggle="popover"]').popover()
    });
</script>
{% endblock %}

{% block navmenu %}
<li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        {{ dash.title }}
    </a>
    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
        {% for d in dashes %}
        <a class="dropdown-item" href="{{ url_for('home', dash_selected=d.1) }}"><i class="{{ 'fas' if d.0 == dash.title else 'far' }} fa-circle" data-fa-transform="shrink-4"></i> {{ d.0 }}</a>
        {% endfor %}
    </div>
</li>
{% endblock %}

{% block body %}

{% if dash %}
<div class="grid">
    {% for plot in dash.plots %}
    <div class="grid-item grid-item-w-{{ plot.width }}">
        <div class="grid-item-inner">
            <div class="card">
                <div class="card-header">
                    <div class="row">
                        <div class="col lead">{{ plot.title }}</div>
                        <div class="col">
                            <div class="col text-right">
                                {% if plot.help %}
                                <a href="#" class="info-icon" data-container="body" data-toggle="popover" data-placement="bottom" data-content="{{ plot.help }}">
                                    <i class="fas fa-question-circle" data-fa-transform="grow-2"></i>
                                </a>
                                {% endif %}
                                {% if plot.update_interval %}
                                <i class="fas fa-sync info-icon" alt="Refreshing every"></i> {{ plot.update_interval }}ms {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                        <div id="plot-{{ plot.id }}"></div>
                </div>            
            </div>
            {% include 'dashboard/plots/' + plot.type + '.html' %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="jumbotron">
    <h1 class="display-4">No Dashboards configured</h1>
    <p class="lead">To create a dashboad check out the readme file in the '{{ config.DASHBOARDS_PATH }}' directory</p>
    </div>
{% endif %}
{% endblock %}

